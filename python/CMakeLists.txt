
# copy python pyd files
SET(INPUT_LIB_DIR ${VINYL_LIBRARY_OUTPUT_PATH_RELEASE})
SET(OUTPUT_LIB_DIR ${VINYL_PATH}/python/pyvinyl)
function(copy_vinyl_lib)
    IF(VINYL_FEATURE_INPUT_API_WINDOWS)
        IF(EXISTS ${OUTPUT_LIB_DIR}/vinyl.dll)
            file(REMOVE ${OUTPUT_LIB_DIR}/vinyl.dll)
        ENDIF()
        file(COPY ${INPUT_LIB_DIR}/vinyl.dll DESTINATION ${OUTPUT_LIB_DIR})
    ELSEIF(VINYL_FEATURE_INPUT_API_ANDROID)
        IF(EXISTS ${OUTPUT_LIB_DIR}/vinyl.dll)
            file(REMOVE ${OUTPUT_LIB_DIR}/vinyl.dll)
        ENDIF()
        file(COPY ${INPUT_LIB_DIR}/vinyl.so DESTINATION ${OUTPUT_LIB_DIR})
    ELSEIF(VINYL_FEATURE_INPUT_API_NULL)
        IF(EXISTS ${OUTPUT_LIB_DIR}/vinyl.dll)
            file(REMOVE ${OUTPUT_LIB_DIR}/vinyl.dll)
        ENDIF()
        file(COPY ${INPUT_LIB_DIR}/vinyl.so DESTINATION ${OUTPUT_LIB_DIR})
    ELSE()
        MESSAGE("Not supported yet")
    ENDIF()
endfunction()

function(rename_vinyl_pyd)
    IF(VINYL_FEATURE_INPUT_API_WINDOWS)
        IF(EXISTS ${OUTPUT_LIB_DIR}/vinyl.pyd)
            file(REMOVE ${OUTPUT_LIB_DIR}/vinyl.pyd)
        ENDIF()
        file(RENAME ${OUTPUT_LIB_DIR}/vinyl.dll ${OUTPUT_LIB_DIR}/vinyl.pyd)
    ELSEIF(VINYL_FEATURE_INPUT_API_ANDROID)
        IF(EXISTS ${OUTPUT_LIB_DIR}/vinyl.pyd)
            file(REMOVE ${OUTPUT_LIB_DIR}/vinyl.pyd)
        ENDIF()
        file(RENAME ${OUTPUT_LIB_DIR}/vinyl.so ${OUTPUT_LIB_DIR}/vinyl.pyd)
    ELSEIF(VINYL_FEATURE_INPUT_API_NULL)
        IF(EXISTS ${OUTPUT_LIB_DIR}/vinyl.pyd)
            file(REMOVE ${OUTPUT_LIB_DIR}/vinyl.pyd)
        ENDIF()
        file(RENAME ${OUTPUT_LIB_DIR}/vinyl.so ${OUTPUT_LIB_DIR}/vinyl.pyd)
    ELSE()
        MESSAGE("Not supported yet")
    ENDIF()
endfunction()

add_custom_target(vinyl_pyd DEPENDS copy_vinyl_lib rename_vinyl_pyd)
